---
layout:     post                    
title:      Java反射和注解
subtitle:   java基础               
date:       2019-9-20               
author:     极客小祥                      
header-img: img/text/19-9-20.jpg   
catalog: true                        
tags:                                
    - JAVA
---

# 反射
被称为**框架设计的灵魂**
* 介绍：**将类的各个组成部分封装为其他对象**，称为反射机制
* 好处：
    1. 可以在程序运行过程中，操作这些对象
    2. 可以解耦，提高程序可扩展性
#### 获取Class对象的方式：
1. **Class.forName("全类名")**：将字节码文件**加载进内存**，返回Class对象
    * **多用于配置文件**，将类定义在配置文件中，读取文件，加载类
```java
Class cls1 = Class.forName("io.jtxyh.demo.Person");
```
2. **类名.class**：通过类名的属性class获取
    * **多用于参数的传递**
```java
Class cls2 = Person.class;
```
3. **对象.getClass()**：getClass()方法在**Object类中定义**，所有对象都有这个方法
    * **多用于对象获取字节码的方式**
```java
Person p = new Person();
Class cls3 = p.getClass();
```
* **结论**：同一个字节码文件(\*.class)在一次程序的运行过程中，**只会被加载一次，不论是通过哪一种方式获取的Class对象都是同一个**
#### 使用Class对象功能：
* 获取功能：
    1. 获取成员变量
        * *Field[]* **getFields()**：获取所有**public**修饰的成员变量
        * *Field* **getField(String name)**：获取**指定名称**的**public**修饰的成员变量
        * *Field[]* **getDeclaredFields()**：获取所有的成员变量
        * *Field* **getDeclaredField(String name)**：获取**指定名称**的成员变量
        ```java
        Field[] fie1 = cls1.getFields();
        for (Field field : fie1) {
            System.out.println(field);  // public java.lang.String io.jtxyh.demo.Person.a
        }
        ```
    2. 获取构造方法
        * *Constructor<?>[]* **getConstructors()**：获取所有**public**修饰的构造器
        * *Constructor<T>* **getConstructor(类<?>... parameterTypes)**：获取一个**指定名称**的**public**修饰的构造器
        * *Constructor<?>[]* **getDeclaredConstructors()**：获取所有的构造器
        * *Constructor<T>* **getDeclaredConstructors(类<?>... parameterTypes)**：获取所有**指定名称**的构造器
        ```java
        Constructor cos1 = cls1.getConstructor(String.class,Integer.class); // 获取有参的
        Object p2 = cos1.newInstance("张三",100);
        System.out.println(p2);
        ```
    3. 获取成员方法
        * *Method[]* **getMethods()**：获取所有**public**修饰的成员方法
        * *Method* **getMethods(String name, 类<?>... parameterTypes)**：获取一个**指定名称**的**public**修饰的成员方法
        * *Method[]* **getDeclaredMethods()**：获取所有的成员方法
        * *Method* **getDeclaredMethods(String name, 类<?>... parameterTypes)**：获取所有**指定名称**的成员方法
        ```java
        Method meth2 = cls1.getMethod("eat", String.class); // 指定一个有一个参数的eat方法
        meth2.invoke(person, "西瓜");
        ```
    4. 获取类名
        * *String* **getName()**：
* **Field**：成员变量
    1. 设置值：*void* **set(Object obj, Object value)**
    2. 获取值：**get(Object obj)**
    3. 忽略访问权限修饰符的安全检查：**setAccessible(true)**  *暴力反射*
* **Constructor**：构造方法
    1. 创建对象：*T* **newInstance(Object... initargs)**
    2. 如果是用空参数构造方法创建对象,直接可以使用：**Class对象的newInstance方法**
* **Method**：方法对象
    1. 执行方法：*Object* **invoke(Object obj, Object...args)**
    2. 获取方法名称：*String* **getName**
        
# 反射
